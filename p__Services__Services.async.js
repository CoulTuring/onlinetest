(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[94],{eDlr:function(e,t,a){"use strict";a.r(t);a("IzEo");var n=a("bx4M"),r=(a("qVdP"),a("jsC+")),c=(a("lUTK"),a("BvKs")),s=(a("P2fV"),a("NJEC")),i=(a("Awhp"),a("KrTs")),o=(a("Pwec"),a("CtXQ")),l=(a("5NDa"),a("5rEg")),m=(a("+L6B"),a("2/Rp")),d=(a("2qtc"),a("kLXV")),u=(a("T2oS"),a("W9HT")),p=(a("miYZ"),a("tsqr")),f=a("qIgq"),b=a.n(f),g=a("d6i3"),h=a.n(g),v=a("1l/V"),C=a.n(v),E=a("p0pE"),O=a.n(E),k=a("2Taf"),w=a.n(k),x=a("vZ4D"),y=a.n(x),M=a("l4Ni"),j=a.n(M),S=a("ujKo"),T=a.n(S),V=a("MhPg"),I=a.n(V),F=(a("g9YV"),a("wCAj")),q=a("q1tI"),z=a.n(q),B=a("MuoO"),N=a("LLXN"),D=a("zHco"),P=a("FkSf"),K=(a("y8nQ"),a("Vl3Y")),_=a("d/v1"),A=a("pJVQ"),J=a("p9nB"),L=a("WAby"),Q=function(e){},X=function(e){function t(){var e,a;w()(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return a=j()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={},a}return I()(t,e),y()(t,[{key:"componentDidMount",value:function(){this.props.service}},{key:"render",value:function(){var e=this.props,t=e.categories,a=e.handleSubmit,n=e.submitButtonText,r=e.submitting;return z.a.createElement("div",null,z.a.createElement(K["a"],{onSubmit:a,layout:"horizontal",className:"modal-form"},z.a.createElement(_["a"],{name:"name",type:"text",size:"default",placeholder:"",label:Object(N["formatMessage"])({id:"common.brand-name"}),hasFeedback:!0,labelCol:{span:6},wrapperCol:{span:18},component:J["g"]}),z.a.createElement(_["a"],{name:"english_name",type:"text",size:"default",placeholder:"",label:Object(N["formatMessage"])({id:"common.english-name"}),required:!0,hasFeedback:!0,validate:[L["g"]],labelCol:{span:6},wrapperCol:{span:18},component:J["g"]}),z.a.createElement(_["a"],{name:"description",type:"text",size:"default",placeholder:"",label:Object(N["formatMessage"])({id:"common.description"}),labelCol:{span:6},wrapperCol:{span:18},component:J["f"]}),z.a.createElement(_["a"],{name:"category",label:Object(N["formatMessage"])({id:"app.services.categories"}),size:"default",labelCol:{span:6},wrapperCol:{span:18},options:t,required:!0,hasFeedback:!0,validate:[L["g"]],component:J["d"]}),z.a.createElement(_["a"],{name:"url",type:"text",size:"default",placeholder:"",label:Object(N["formatMessage"])({id:"common.url"}),required:!0,hasFeedback:!0,validate:[L["g"]],labelCol:{span:6},wrapperCol:{span:18},component:J["g"]}),z.a.createElement(_["a"],{name:"icon",type:"text",size:"default",placeholder:"",label:Object(N["formatMessage"])({id:"common.icon"}),required:!0,hasFeedback:!0,validate:[L["g"]],labelCol:{span:6},wrapperCol:{span:18},component:J["g"]}),z.a.createElement(_["a"],{name:"background_color",type:"text",size:"default",placeholder:"",label:Object(N["formatMessage"])({id:"common.background-color"}),required:!0,hasFeedback:!0,validate:[L["g"]],labelCol:{span:6},wrapperCol:{span:18},component:J["g"]}),z.a.createElement(_["a"],{name:"serial",type:"text",size:"default",placeholder:"",label:Object(N["formatMessage"])({id:"common.serial"}),required:!0,hasFeedback:!0,validate:[L["g"]],labelCol:{span:6},wrapperCol:{span:18},component:J["b"]}),z.a.createElement(_["a"],{name:"online",label:Object(N["formatMessage"])({id:"common.online"}),size:"default",labelCol:{span:6},wrapperCol:{span:18},defaultChecked:!0,checkedChildren:Object(N["formatMessage"])({id:"common.online"}),unCheckedChildren:Object(N["formatMessage"])({id:"common.offline"}),component:J["e"]}),z.a.createElement(m["a"],{type:"primary",htmlType:"submit",disabled:r,className:"modal-form-button"},n)))}}]),t}(z.a.Component),Y=Object(A["a"])({form:"serviceForm",validate:Q})(X);function H(e,t){var a=t.service;return{initialValues:a,service:t.service,submitButtonText:t.submitButtonText||Object(N["formatMessage"])({id:"common.submit"})}}var W,Z,R,U=Object(B["connect"])(H)(Y),G=a("6NK7"),$=a("00B6"),ee=F["a"].Column,te=(W=Object(B["connect"])(function(e){return{loading:e.loading.effects["services/services/fetch"],list:e["services/services"].data.list,pagination:e["services/services"].data.pagination}}),W((R=function(e){function t(){var e,a;w()(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return a=j()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={service:null,categoriesOptions:[],categoriesSelectOptions:[],ordering:"",filters:null,filterVisible:!1,filtered:!1,searchText:"",modalTitle:"",modalContent:null,submitButtonText:"",modalVisible:!1,submitting:!1},a.fetchServices=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=a.props,n=t.dispatch,r=t.pagination,c=a.state,s=c.ordering,i=c.filters,o=c.searchText;n(e?{type:"services/services/fetch",payload:e}:{type:"services/services/fetch",payload:O()({search:o,page:r?r.current:1,ordering:s},i)})},a.fetchCategories=function(){var e=a.props.dispatch;e({type:"services/categories/fetchSimplePublic",payload:{},callback:a.fetchCategoriesCallback})},a.fetchCategoriesCallback=function(e){a.setState({categoriesOptions:e.map(function(e){return Object.assign({},{text:e.name,value:e.name})}),categoriesSelectOptions:e.map(function(e){return Object.assign({},e,{key:e.name,value:e.name,label:"".concat(e.name)})})})},a.handleTableChange=function(){var e=C()(h.a.mark(function e(t,n,r){var c,s;return h.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return c=a.state.searchText,s=G["a"].transferSorterToOrdering(r),e.next=4,a.fetchServices(O()({search:c,page:t.current,ordering:s},n));case 4:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.editService=C()(h.a.mark(function e(){var t,n,r,c,s,i,o,l,m=arguments;return h.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:null,n=a.state,r=n.categoriesSelectOptions,c=n.submitting,s=null===t?["\u521b\u5efa\u623f\u95f4","\u521b\u5efa"]:["\u7f16\u8f91\u623f\u95f4","\u7f16\u8f91"],i=b()(s,2),o=i[0],l=i[1],e.next=5,a.setState({service:t?O()({},t):{}});case 5:return e.next=7,a.setState({modalTitle:o,modalContent:z.a.createElement(U,{service:a.state.service,categories:r,title:o,submitButtonText:l,onSubmit:a.onSubmit,submitting:c}),submitButtonText:l,modalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.deleteService=function(){var e=C()(h.a.mark(function e(t){var n;return h.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"services/services/remove",payload:{service:t},callback:function(){return a.deleteServiceCallback(t["name"])}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.deleteServiceCallback=function(e){p["a"].success("".concat(Object(N["formatMessage"])({id:"operations.success-delete"},{name:Object(N["formatMessage"])({id:"app.services.services"})})," ").concat(e)),a.fetchServices()},a.onInputChange=function(e){a.setState({searchText:e.target.value})},a.onServiceSearch=C()(h.a.mark(function e(){var t,n,r,c;return h.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state,n=t.ordering,r=t.filters,c=t.searchText,e.next=3,a.fetchServices(O()({search:c,page:1,ordering:n},r));case 3:a.setState({filterVisible:!1,filtered:!!c});case 4:case"end":return e.stop()}},e)})),a.handleCancel=C()(h.a.mark(function e(){return h.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.setState({modalVisible:!1,modalContent:null});case 2:case"end":return e.stop()}},e)})),a.onSubmit=function(){var e=C()(h.a.mark(function e(t){var n,r,c;return h.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.service,c=O()({},t,{online:!!t["online"]}),console.warn("new values: ",c),e.prev=4,e.next=7,a.setState({submitting:!0});case 7:r&&r["name"]?n({type:"services/services/update",payload:{service:O()({},c)},callback:function(){return a.onSubmitCallback("".concat(Object(N["formatMessage"])({id:"operations.success-edit"},{name:Object(N["formatMessage"])({id:"app.services.services"})})," ").concat(name))}}):n({type:"services/services/add",payload:{service:c},callback:function(){return a.onSubmitCallback("".concat(Object(N["formatMessage"])({id:"operations.success-create"},{name:Object(N["formatMessage"])({id:"app.services.services"})})," ").concat(name))}}),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](4),console.log(e.t0);case 13:return e.prev=13,e.next=16,a.setState({submitting:!1});case 16:return e.finish(13);case 17:return e.next=19,a.setState({modalVisible:!1,modalContent:null});case 19:case"end":return e.stop()}},e,null,[[4,10,13,17]])}));return function(t){return e.apply(this,arguments)}}(),a}return I()(t,e),y()(t,[{key:"componentDidMount",value:function(){this.fetchServices(),this.fetchCategories()}},{key:"onSubmitCallback",value:function(e){p["a"].success(e),this.fetchServices()}},{key:"render",value:function(){var e=this,t=this.props,a=t.list,p=t.pagination,f=t.loading,b=this.state,g=b.categoriesOptions,h=b.filtered,v=b.filterVisible,C=b.modalTitle,E=b.modalContent,O=b.modalVisible;return console.warn("list, pages, loading:",a,p,f),z.a.createElement(D["a"],{title:Object(N["formatMessage"])({id:"operations.management"},{name:Object(N["formatMessage"])({id:"app.services.services"})})},z.a.createElement(n["a"],{bordered:!1},p&&z.a.createElement(P["a"],null,p.total),z.a.createElement(d["a"],{title:C,visible:O,onCancel:this.handleCancel,footer:null},E||z.a.createElement(u["a"],{spinning:f})),z.a.createElement(m["a"],{type:"primary",onClick:function(){return e.editService()}},z.a.createElement(N["FormattedMessage"],{id:"operations.create",values:{name:Object(N["formatMessage"])({id:"app.services.services"})}})),z.a.createElement(F["a"],{dataSource:a,loading:f,rowKey:"name",onChange:this.handleTableChange,pagination:p,width:1200,scroll:{x:1200}},z.a.createElement(ee,{title:Object(N["formatMessage"])({id:"common.brand-name"}),dataIndex:"name",filterDropdown:z.a.createElement("div",{className:"table-input-search"},z.a.createElement(l["a"],{placeholder:Object(N["formatMessage"])({id:"common.brand-name"}),value:this.state.searchText,onChange:this.onInputChange,onPressEnter:this.onServiceSearch}),z.a.createElement(m["a"],{type:"primary",onClick:this.onServiceSearch},z.a.createElement(N["FormattedMessage"],{id:"common.search"}))),filterIcon:z.a.createElement(o["a"],{type:"search",style:{color:h?"#108ee9":"#aaa"}}),filterDropdownVisible:v,onFilterDropdownVisibleChange:function(t){e.setState({filterVisible:t})}}),z.a.createElement(ee,{title:Object(N["formatMessage"])({id:"common.english-name"}),dataIndex:"english_name"}),z.a.createElement(ee,{title:Object(N["formatMessage"])({id:"common.description"}),dataIndex:"description"}),z.a.createElement(ee,{title:Object(N["formatMessage"])({id:"app.services.categories"}),dataIndex:"category",filters:g}),z.a.createElement(ee,{title:Object(N["formatMessage"])({id:"common.url"}),dataIndex:"url"}),z.a.createElement(ee,{title:Object(N["formatMessage"])({id:"common.icon"}),render:function(e,t){return t["icon"]&&t["background_color"]?$["a"].assembleIcon(t["icon"],15,t["background_color"]):null}}),z.a.createElement(ee,{title:Object(N["formatMessage"])({id:"common.icon-name"}),dataIndex:"icon"}),z.a.createElement(ee,{title:Object(N["formatMessage"])({id:"common.background-color"}),dataIndex:"background_color"}),z.a.createElement(ee,{title:Object(N["formatMessage"])({id:"common.serial"}),dataIndex:"serial"}),z.a.createElement(ee,{title:Object(N["formatMessage"])({id:"common.online"}),dataIndex:"online",render:function(e){return e?z.a.createElement(i["a"],{status:"success",text:Object(N["formatMessage"])({id:"common.online"})}):z.a.createElement(i["a"],{status:"default",text:Object(N["formatMessage"])({id:"common.offline"})})}}),z.a.createElement(ee,{title:Object(N["formatMessage"])({id:"common.operations"}),width:152,fixed:"right",render:function(t,a){return z.a.createElement("div",null,z.a.createElement("a",{onClick:function(){return e.editService(a)}},Object(N["formatMessage"])({id:"common.edit"})),z.a.createElement("span",{className:"ant-divider"}),z.a.createElement(r["a"],{overlay:z.a.createElement(c["a"],null,z.a.createElement(c["a"].Item,null,z.a.createElement(s["a"],{title:Object(N["formatMessage"])({id:"common.delete-ask"}),onConfirm:function(){return e.deleteService(a)}},z.a.createElement("a",{href:"#"},z.a.createElement(N["FormattedMessage"],{id:"common.delete"})))))},z.a.createElement("a",{className:"ant-dropdown-link"},z.a.createElement(N["FormattedMessage"],{id:"common.more"})," ",z.a.createElement(o["a"],{type:"down"}))))}}))))}}]),t}(q["PureComponent"]),Z=R))||Z);t["default"]=te}}]);