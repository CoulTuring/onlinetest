(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[77],{oTPe:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,l,s,r=a("bx4M"),i=(a("qVdP"),a("jsC+")),c=(a("lUTK"),a("BvKs")),o=(a("P2fV"),a("NJEC")),u=(a("Pwec"),a("CtXQ")),m=(a("5NDa"),a("5rEg")),d=(a("+L6B"),a("2/Rp")),p=(a("2qtc"),a("kLXV")),f=(a("T2oS"),a("W9HT")),h=(a("miYZ"),a("tsqr")),b=a("qIgq"),E=a.n(b),g=a("d6i3"),S=a.n(g),x=a("1l/V"),v=a.n(x),w=a("p0pE"),y=a.n(w),C=a("2Taf"),k=a.n(C),j=a("vZ4D"),T=a.n(j),q=a("l4Ni"),N=a.n(q),V=a("ujKo"),O=a.n(V),I=a("MhPg"),D=a.n(I),P=(a("14J3"),a("BMrR")),B=(a("jCWc"),a("kPKH")),K=(a("g9YV"),a("wCAj")),A=a("q1tI"),M=a.n(A),J=a("MuoO"),R=a("zHco"),F=a("6NK7"),H=a("FkSf"),W=a("cZtN"),Z=a("hEA0"),_=a.n(Z),z=K["a"].Column,L=function(e){return M.a.createElement("div",null,M.a.createElement(P["a"],{gutter:12},M.a.createElement(B["a"],{xs:6,sm:4,className:_.a["detail-label"]},"\u9898\u5e72:"),M.a.createElement(B["a"],{xs:18,sm:20},e.selection["question"])),M.a.createElement(P["a"],{gutter:12},M.a.createElement(B["a"],{xs:6,sm:4,className:_.a["detail-label"]},"A."),M.a.createElement(B["a"],{xs:18,sm:20},e.selection["A"])),M.a.createElement(P["a"],{gutter:12},M.a.createElement(B["a"],{xs:6,sm:4,className:_.a["detail-label"]},"B."),M.a.createElement(B["a"],{xs:18,sm:20},e.selection["B"])),M.a.createElement(P["a"],{gutter:12},M.a.createElement(B["a"],{xs:6,sm:4,className:_.a["detail-label"]},"C."),M.a.createElement(B["a"],{xs:18,sm:20},e.selection["C"])),M.a.createElement(P["a"],{gutter:12},M.a.createElement(B["a"],{xs:6,sm:4,className:_.a["detail-label"]},"D."),M.a.createElement(B["a"],{xs:18,sm:20},e.selection["D"])),M.a.createElement(P["a"],{gutter:12},M.a.createElement(B["a"],{xs:6,sm:4,className:_.a["detail-label"]},"E."),M.a.createElement(B["a"],{xs:18,sm:20},e.selection["E"])),M.a.createElement(P["a"],{gutter:12},M.a.createElement(B["a"],{xs:6,sm:4,className:_.a["detail-label"]},"\u7b54\u6848:"),M.a.createElement(B["a"],{xs:18,sm:20},e.selection["answer_displayed"]||e.selection["answer"])))},X=(n=Object(J["connect"])(function(e){return{loading:e["questions/selections"].loading,list:e["questions/selections"].data.list,pagination:e["questions/selections"].data.pagination}}),n((s=function(e){function t(){var e,a;k()(this,t);for(var n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return a=N()(this,(e=O()(t)).call.apply(e,[this].concat(l))),a.state={selection:null,subjectsOptions:[],subjectsSelectOptions:[],ordering:"",filters:null,filterVisible:!1,filtered:!1,searchText:"",modalTitle:"",modalContent:null,submitButtonText:"",modalVisible:!1,submitting:!1},a.fetchSubjects=function(){var e=a.props.dispatch;e({type:"knowledge/subjects/fetchPublic",payload:{},callback:a.fetchSubjectsCallback})},a.fetchSubjectsCallback=function(e){a.setState({subjectsOptions:F["a"].transferObjectsToFilterOptions(e)}),a.setState({subjectsSelectOptions:F["a"].transferObjectsToSelectOptionsWithoutID(e)})},a.fetchSelections=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=a.props,n=t.dispatch,l=t.pagination,s=a.state,r=s.ordering,i=s.filters,c=s.searchText;n(e?{type:"questions/selections/fetch",payload:e}:{type:"questions/selections/fetch",payload:y()({search:c,page:l?l.current:1,ordering:r},i)})},a.onInputChange=function(e){a.setState({searchText:e.target.value})},a.onSelectionSearch=v()(S.a.mark(function e(){var t,n,l,s;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.state,n=t.ordering,l=t.filters,s=t.searchText,a.fetchSelections(y()({search:s,page:1,ordering:n},l)),a.setState({filterVisible:!1,filtered:!!s});case 3:case"end":return e.stop()}},e)})),a.handleTableChange=function(){var e=v()(S.a.mark(function e(t,n,l){var s,r;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:s=a.state.searchText,r=F["a"].transferSorterToOrdering(l),a.setState({ordering:r,filters:n}),a.fetchSelections(y()({search:s,page:t.current,ordering:r},n));case 4:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.editSelection=v()(S.a.mark(function e(){var t,n,l,s,r,i,c,o,u=arguments;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:null,n=a.state,l=n.subjectsSelectOptions,s=n.submitting,r=null===t?["\u521b\u5efa\u5355\u9009\u9898","\u521b\u5efa"]:["\u7f16\u8f91\u5355\u9009\u9898","\u7f16\u8f91"],i=E()(r,2),c=i[0],o=i[1],e.next=5,a.setState({selection:t||{difficulty_level:1}});case 5:return e.next=7,a.setState({modalTitle:c,modalContent:M.a.createElement(W["a"],{selection:a.state.selection,subjects:l,title:c,submitButtonText:o,onSubmit:a.onSubmit,submitting:s}),submitButtonText:o,modalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.deleteSelection=function(){var e=v()(S.a.mark(function e(t){var n;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"questions/selections/remove",payload:{selection:t},callback:a.deleteSelectionCallback});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.deleteSelectionCallback=function(){h["a"].success("\u6210\u529f\u5220\u9664\u8be5\u5355\u9009\u9898\u3002"),a.fetchSelections()},a.handleCancel=v()(S.a.mark(function e(){return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.setState({modalVisible:!1,modalContent:null});case 2:case"end":return e.stop()}},e)})),a.onSubmit=function(){var e=v()(S.a.mark(function e(t){var n,l,s;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,l=a.state.selection,s=y()({},t),e.prev=3,e.next=6,a.setState({submitting:!0});case 6:if(!l||!l["id"]){e.next=11;break}return e.next=9,n({type:"questions/selections/update",payload:{selection:s},callback:function(){return a.fetchSelections()}});case 9:e.next=13;break;case 11:return e.next=13,n({type:"questions/selections/add",payload:{selection:s},callback:function(){return a.fetchSelections()}});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](3),console.log(e.t0);case 18:return e.prev=18,e.next=21,a.setState({submitting:!1});case 21:return e.finish(18);case 22:return e.next=24,a.setState({modalVisible:!1,modalContent:null});case 24:case"end":return e.stop()}},e,null,[[3,15,18,22]])}));return function(t){return e.apply(this,arguments)}}(),a}return D()(t,e),T()(t,[{key:"componentDidMount",value:function(){this.fetchSubjects(),this.fetchSelections()}},{key:"render",value:function(){var e=this,t=this.props,a=t.list,n=t.pagination,l=t.loading,s=this.state,h=s.subjectsOptions,b=s.filtered,E=s.filterVisible,g=s.modalTitle,S=s.modalContent,x=s.modalVisible;return M.a.createElement(R["a"],{title:"\u5355\u9009\u9898\u5217\u8868"},M.a.createElement(r["a"],{bordered:!1},n&&M.a.createElement(H["a"],null,n.total),M.a.createElement(p["a"],{title:g,visible:x,wrapClassName:"vertical-center-modal",onCancel:this.handleCancel,footer:null},S||M.a.createElement(f["a"],{spinning:l})),M.a.createElement(d["a"],{type:"primary",onClick:function(){return e.editSelection()}},"\u65b0\u5efa\u5355\u9009\u9898"),M.a.createElement(K["a"],{dataSource:a,expandedRowRender:function(e){return M.a.createElement(L,{selection:e})},loading:l,rowKey:"id",onChange:this.handleTableChange,pagination:n},M.a.createElement(z,{title:"\u9898\u5e72",dataIndex:"question",key:"question",width:400,style:_.a.question,filterDropdown:M.a.createElement("div",{className:"table-input-search"},M.a.createElement(m["a"],{placeholder:"\u9898\u5e72",value:this.state.searchText,onChange:this.onInputChange,onPressEnter:this.onSelectionSearch}),M.a.createElement(d["a"],{type:"primary",onClick:this.onSelectionSearch},"\u68c0\u7d22")),filterIcon:M.a.createElement(u["a"],{type:"search",style:{color:b?"#108ee9":"#aaa"}}),filterDropdownVisible:E,onFilterDropdownVisibleChange:function(t){e.setState({filterVisible:t})}}),M.a.createElement(z,{title:"\u79d1\u76ee",dataIndex:"subject",key:"subject",filters:h,render:function(e,t){return t.subject_name}}),M.a.createElement(z,{title:"\u6700\u540e\u4fee\u6539\u65e5\u671f\u65f6\u95f4",sorter:!0,dataIndex:"modified"}),M.a.createElement(z,{title:"\u64cd\u4f5c",render:function(t,a){return M.a.createElement("div",null,M.a.createElement("a",{onClick:function(){return e.editSelection(a)}},"\u7f16\u8f91"),M.a.createElement("span",{className:"ant-divider"}),M.a.createElement(i["a"],{overlay:M.a.createElement(c["a"],null,M.a.createElement(c["a"].Item,null,M.a.createElement(o["a"],{title:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",onConfirm:function(){return e.deleteSelection(a)}},M.a.createElement("a",{href:"#"},"\u5220\u9664"))))},M.a.createElement("a",{className:"ant-dropdown-link"},"\u66f4\u591a ",M.a.createElement(u["a"],{type:"down"}))))}}))))}}]),t}(A["PureComponent"]),l=s))||l);t["default"]=X}}]);