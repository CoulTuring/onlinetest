(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[76],{Wxv7:function(e,t,a){"use strict";a.r(t);a("IzEo");var n=a("bx4M"),l=(a("qVdP"),a("jsC+")),i=(a("lUTK"),a("BvKs")),s=(a("P2fV"),a("NJEC")),r=(a("Pwec"),a("CtXQ")),c=(a("5NDa"),a("5rEg")),o=(a("+L6B"),a("2/Rp")),u=(a("2qtc"),a("kLXV")),m=(a("T2oS"),a("W9HT")),p=(a("miYZ"),a("tsqr")),d=a("qIgq"),h=a.n(d),b=a("d6i3"),f=a.n(b),E=a("1l/V"),g=a.n(E),v=a("p0pE"),x=a.n(v),C=a("2Taf"),y=a.n(C),w=a("vZ4D"),k=a.n(w),S=a("l4Ni"),j=a.n(S),q=a("ujKo"),T=a.n(q),M=a("MhPg"),V=a.n(M),N=(a("14J3"),a("BMrR")),B=(a("jCWc"),a("kPKH")),O=(a("g9YV"),a("wCAj")),z=a("q1tI"),D=a.n(z),F=a("MuoO"),I=a("zHco"),A=a("6NK7"),P=a("FkSf"),K=(a("y8nQ"),a("Vl3Y")),J=a("d/v1"),W=a("pJVQ"),R=a("p9nB"),_=a("WAby"),H=function(e){},Q=function(e){function t(){var e,a;y()(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return a=j()(this,(e=T()(t)).call.apply(e,[this].concat(l))),a.state={},a}return V()(t,e),k()(t,[{key:"render",value:function(){var e=this.props,t=e.subjects,a=e.handleSubmit,n=e.submitButtonText,l=e.submitting;return D.a.createElement("div",null,D.a.createElement(K["a"],{onSubmit:a,layout:"horizontal",className:"modal-form"},D.a.createElement(J["a"],{name:"question",type:"text",size:"default",placeholder:"\u9898\u5e72",label:"\u9898\u5e72",required:!0,hasFeedback:!0,validate:[_["g"]],labelCol:{span:6},wrapperCol:{span:18},component:R["g"]}),D.a.createElement(J["a"],{name:"A",type:"text",size:"default",placeholder:"\u9009\u9879A, \u5fc5\u586b",label:"\u9009\u9879A",required:!0,hasFeedback:!0,validate:[_["g"]],labelCol:{span:6},wrapperCol:{span:18},component:R["g"]}),D.a.createElement(J["a"],{name:"B",type:"text",size:"default",placeholder:"\u9009\u9879B, \u5fc5\u586b",label:"\u9009\u9879B",required:!0,hasFeedback:!0,validate:[_["g"]],labelCol:{span:6},wrapperCol:{span:18},component:R["g"]}),D.a.createElement(J["a"],{name:"C",type:"text",size:"default",placeholder:"\u9009\u9879C, \u5fc5\u586b",label:"\u9009\u9879C",required:!0,hasFeedback:!0,validate:[_["g"]],labelCol:{span:6},wrapperCol:{span:18},component:R["g"]}),D.a.createElement(J["a"],{name:"D",type:"text",size:"default",placeholder:"\u9009\u9879D",label:"\u9009\u9879D",labelCol:{span:6},wrapperCol:{span:18},component:R["g"]}),D.a.createElement(J["a"],{name:"E",type:"text",size:"default",placeholder:"\u9009\u9879E",label:"\u9009\u9879E",labelCol:{span:6},wrapperCol:{span:18},component:R["g"]}),D.a.createElement(J["a"],{name:"subject",label:"\u79d1\u76ee",size:"default",labelCol:{span:6},wrapperCol:{span:18},required:!0,hasFeedback:!0,validate:[_["g"]],options:t,component:R["d"]}),D.a.createElement(J["a"],{name:"difficulty_level",type:"text",size:"default",placeholder:"\u96be\u5ea6\u7b49\u7ea7\u30021\u4e3a\u7b80\u5355\uff0c5\u4e3a\u56f0\u96be",label:"\u96be\u5ea6\u7b49\u7ea7",required:!0,hasFeedback:!0,validate:[_["g"]],labelCol:{span:6},wrapperCol:{span:18},component:R["b"]}),D.a.createElement(J["a"],{name:"answer",type:"text",size:"default",placeholder:"\u7b54\u6848",label:"\u7b54\u6848",required:!0,hasFeedback:!0,validate:[_["g"],_["c"],_["a"],_["h"]],labelCol:{span:6},wrapperCol:{span:18},component:R["g"]}),D.a.createElement(o["a"],{type:"primary",htmlType:"submit",disabled:l,className:"modal-form-button"},n)))}}]),t}(D.a.Component),Y=Object(W["a"])({form:"multiselectionForm",validate:H})(Q);function Z(e,t){var a=t.multiselection;return{initialValues:a,submitButtonText:t.submitButtonText||"\u63d0\u4ea4"}}var L,X,U,G=Object(F["connect"])(Z)(Y),$=a("hEA0"),ee=a.n($),te=(a("cZtN"),O["a"].Column),ae=function(e){return D.a.createElement("div",null,D.a.createElement(N["a"],{gutter:12},D.a.createElement(B["a"],{xs:6,sm:4,className:ee.a["detail-label"]},"\u9898\u5e72:"),D.a.createElement(B["a"],{xs:18,sm:20},e.multiselection["question"])),D.a.createElement(N["a"],{gutter:12},D.a.createElement(B["a"],{xs:6,sm:4,className:ee.a["detail-label"]},"A."),D.a.createElement(B["a"],{xs:18,sm:20},e.multiselection["A"])),D.a.createElement(N["a"],{gutter:12},D.a.createElement(B["a"],{xs:6,sm:4,className:ee.a["detail-label"]},"B."),D.a.createElement(B["a"],{xs:18,sm:20},e.multiselection["B"])),D.a.createElement(N["a"],{gutter:12},D.a.createElement(B["a"],{xs:6,sm:4,className:ee.a["detail-label"]},"C."),D.a.createElement(B["a"],{xs:18,sm:20},e.multiselection["C"])),D.a.createElement(N["a"],{gutter:12},D.a.createElement(B["a"],{xs:6,sm:4,className:ee.a["detail-label"]},"D."),D.a.createElement(B["a"],{xs:18,sm:20},e.multiselection["D"])),D.a.createElement(N["a"],{gutter:12},D.a.createElement(B["a"],{xs:6,sm:4,className:ee.a["detail-label"]},"E."),D.a.createElement(B["a"],{xs:18,sm:20},e.multiselection["E"])),D.a.createElement(N["a"],{gutter:12},D.a.createElement(B["a"],{xs:6,sm:4,className:ee.a["detail-label"]},"\u7b54\u6848:"),D.a.createElement(B["a"],{xs:18,sm:20},e.multiselection["answer_displayed"]||e.multiselection["answer"])))},ne=(L=Object(F["connect"])(function(e){return{loading:e["questions/multiselections"].loading,list:e["questions/multiselections"].data.list,pagination:e["questions/multiselections"].data.pagination}}),L((U=function(e){function t(){var e,a;y()(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return a=j()(this,(e=T()(t)).call.apply(e,[this].concat(l))),a.state={multiselection:null,subjectsOptions:[],subjectsSelectOptions:[],ordering:"",filters:null,filterVisible:!1,filtered:!1,searchText:"",modalTitle:"",modalContent:null,submitButtonText:"",modalVisible:!1,submitting:!1},a.fetchSubjects=function(){var e=a.props.dispatch;e({type:"knowledge/subjects/fetchPublic",payload:{},callback:a.fetchSubjectsCallback})},a.fetchSubjectsCallback=function(e){a.setState({subjectsOptions:A["a"].transferObjectsToFilterOptions(e)}),a.setState({subjectsSelectOptions:A["a"].transferObjectsToSelectOptionsWithoutID(e)})},a.fetchMultiselections=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=a.props,n=t.dispatch,l=t.pagination,i=a.state,s=i.ordering,r=i.filters,c=i.searchText;n(e?{type:"questions/multiselections/fetch",payload:e}:{type:"questions/multiselections/fetch",payload:x()({search:c,page:l?l.current:1,ordering:s},r)})},a.onInputChange=function(e){a.setState({searchText:e.target.value})},a.onMultiselectionSearch=g()(f.a.mark(function e(){var t,n,l,i;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.state,n=t.ordering,l=t.filters,i=t.searchText,a.fetchMultiselections(x()({search:i,page:1,ordering:n},l)),a.setState({filterVisible:!1,filtered:!!i});case 3:case"end":return e.stop()}},e)})),a.handleTableChange=function(){var e=g()(f.a.mark(function e(t,n,l){var i,s;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:i=a.state.searchText,s=A["a"].transferSorterToOrdering(l),a.setState({ordering:s,filters:n}),a.fetchMultiselections(x()({search:i,page:t.current,ordering:s},n));case 4:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.editMultiselection=g()(f.a.mark(function e(){var t,n,l,i,s,r,c,o,u=arguments;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:null,n=a.state,l=n.subjectsSelectOptions,i=n.submitting,s=null===t?["\u521b\u5efa\u591a\u9009\u9898","\u521b\u5efa"]:["\u7f16\u8f91\u591a\u9009\u9898","\u7f16\u8f91"],r=h()(s,2),c=r[0],o=r[1],e.next=5,a.setState({multiselection:t||{difficulty_level:1}});case 5:return e.next=7,a.setState({modalTitle:c,modalContent:D.a.createElement(G,{multiselection:a.state.multiselection,subjects:l,title:c,submitButtonText:o,onSubmit:a.onSubmit,submitting:i}),submitButtonText:o,modalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.deleteMultiselection=function(){var e=g()(f.a.mark(function e(t){var n;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"questions/multiselections/remove",payload:{multiselection:t},callback:a.deleteMultiselectionCallback});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.deleteMultiselectionCallback=function(){p["a"].success("\u6210\u529f\u5220\u9664\u8be5\u591a\u9009\u9898\u3002"),a.fetchMultiselections()},a.handleCancel=g()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.setState({modalVisible:!1,modalContent:null});case 2:case"end":return e.stop()}},e)})),a.onSubmit=function(){var e=g()(f.a.mark(function e(t){var n,l;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,l=a.state.multiselection,e.prev=2,e.next=5,a.setState({submitting:!0});case 5:if(!l||!l["id"]){e.next=10;break}return e.next=8,n({type:"questions/multiselections/update",payload:{multiselection:t},callback:function(){return a.fetchMultiselections()}});case 8:e.next=12;break;case 10:return e.next=12,n({type:"questions/multiselections/add",payload:{multiselection:t},callback:function(){return a.fetchMultiselections()}});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](2),console.log(e.t0);case 17:return e.prev=17,e.next=20,a.setState({submitting:!1});case 20:return e.finish(17);case 21:return e.next=23,a.setState({modalVisible:!1,modalContent:null});case 23:case"end":return e.stop()}},e,null,[[2,14,17,21]])}));return function(t){return e.apply(this,arguments)}}(),a}return V()(t,e),k()(t,[{key:"componentDidMount",value:function(){this.fetchSubjects(),this.fetchMultiselections()}},{key:"render",value:function(){var e=this,t=this.props,a=t.list,p=t.pagination,d=t.loading,h=this.state,b=h.subjectsOptions,f=h.filtered,E=h.filterVisible,g=h.modalTitle,v=h.modalContent,x=h.modalVisible;return D.a.createElement(I["a"],{title:"\u591a\u9009\u9898\u5217\u8868"},D.a.createElement(n["a"],{bordered:!1},p&&D.a.createElement(P["a"],null,p.total),D.a.createElement(u["a"],{title:g,visible:x,wrapClassName:"vertical-center-modal",onCancel:this.handleCancel,footer:null},v||D.a.createElement(m["a"],{spinning:d})),D.a.createElement(o["a"],{type:"primary",onClick:function(){return e.editMultiselection()}},"\u65b0\u5efa\u591a\u9009\u9898"),D.a.createElement(O["a"],{dataSource:a,expandedRowRender:function(e){return D.a.createElement(ae,{multiselection:e})},loading:d,rowKey:"id",onChange:this.handleTableChange,pagination:p},D.a.createElement(te,{title:"\u9898\u5e72",dataIndex:"question",key:"question",width:400,style:ee.a.question,filterDropdown:D.a.createElement("div",{className:"table-input-search"},D.a.createElement(c["a"],{placeholder:"\u9898\u5e72",value:this.state.searchText,onChange:this.onInputChange,onPressEnter:this.onMultiselectionSearch}),D.a.createElement(o["a"],{type:"primary",onClick:this.onMultiselectionSearch},"\u68c0\u7d22")),filterIcon:D.a.createElement(r["a"],{type:"search",style:{color:f?"#108ee9":"#aaa"}}),filterDropdownVisible:E,onFilterDropdownVisibleChange:function(t){e.setState({filterVisible:t})}}),D.a.createElement(te,{title:"\u79d1\u76ee",dataIndex:"subject",key:"subject",filters:b,render:function(e,t){return t.subject_name}}),D.a.createElement(te,{title:"\u6700\u540e\u4fee\u6539\u65e5\u671f\u65f6\u95f4",sorter:!0,dataIndex:"modified"}),D.a.createElement(te,{title:"\u64cd\u4f5c",render:function(t,a){return D.a.createElement("div",null,D.a.createElement("a",{onClick:function(){return e.editMultiselection(a)}},"\u7f16\u8f91"),D.a.createElement("span",{className:"ant-divider"}),D.a.createElement(l["a"],{overlay:D.a.createElement(i["a"],null,D.a.createElement(i["a"].Item,null,D.a.createElement(s["a"],{title:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",onConfirm:function(){return e.deleteMultiselection(a)}},D.a.createElement("a",{href:"#"},"\u5220\u9664"))))},D.a.createElement("a",{className:"ant-dropdown-link"},"\u66f4\u591a ",D.a.createElement(r["a"],{type:"down"}))))}}))))}}]),t}(z["PureComponent"]),X=U))||X);t["default"]=ne}}]);