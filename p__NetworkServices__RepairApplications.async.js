(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[59],{zYhi:function(e,t,a){"use strict";a.r(t);a("IzEo");var n=a("bx4M"),r=(a("qVdP"),a("jsC+")),i=(a("P2fV"),a("NJEC")),o=(a("lUTK"),a("BvKs")),s=(a("Awhp"),a("KrTs")),c=(a("Pwec"),a("CtXQ")),l=(a("5NDa"),a("5rEg")),p=(a("+L6B"),a("2/Rp")),m=(a("2qtc"),a("kLXV")),u=(a("T2oS"),a("W9HT")),d=(a("miYZ"),a("tsqr")),f=a("qIgq"),b=a.n(f),h=a("d6i3"),g=a.n(h),v=a("1l/V"),w=a.n(v),x=a("p0pE"),k=a.n(x),E=a("2Taf"),O=a.n(E),y=a("vZ4D"),A=a.n(y),S=a("l4Ni"),j=a.n(S),C=a("ujKo"),M=a.n(C),T=a("MhPg"),R=a.n(T),V=(a("g9YV"),a("wCAj")),I=a("q1tI"),B=a.n(I),F=a("MuoO"),N=a("LLXN"),q=a("zHco"),z=a("FkSf"),_=(a("y8nQ"),a("Vl3Y")),D=a("d/v1"),K=a("pJVQ"),P=a("p9nB"),J=a("WAby"),L=a("6NK7"),Y=a("Tt/K"),Q=function(e){},W=function(e){function t(){var e,a;O()(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return a=j()(this,(e=M()(t)).call.apply(e,[this].concat(r))),a.state={},a}return R()(t,e),A()(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.rooms,a=e.handleSubmit,n=e.submitButtonText,r=e.submitting;return B.a.createElement("div",null,B.a.createElement(_["a"],{onSubmit:a,layout:"horizontal",className:"modal-form"},B.a.createElement(D["a"],{name:"category",type:"text",size:"default",label:Object(N["formatMessage"])({id:"common.category"}),labelCol:{span:6},wrapperCol:{span:18},required:!0,hasFeedback:!0,onSelect:this.handleCategorySelect,validate:[J["g"]],options:Y["n"],component:P["d"]}),B.a.createElement(D["a"],{name:"title",type:"text",size:"default",placeholder:"",label:Object(N["formatMessage"])({id:"common.title"}),required:!0,hasFeedback:!0,validate:[J["g"]],labelCol:{span:6},wrapperCol:{span:18},component:P["g"]}),B.a.createElement(D["a"],{name:"content",type:"text",size:"default",placeholder:"",label:Object(N["formatMessage"])({id:"common.content"}),required:!0,hasFeedback:!0,labelCol:{span:6},wrapperCol:{span:18},component:P["f"]}),B.a.createElement(D["a"],{name:"room",label:Object(N["formatMessage"])({id:"app.rooms.room"}),size:"default",labelCol:{span:6},wrapperCol:{span:18},options:t,required:!0,hasFeedback:!0,component:P["d"]}),B.a.createElement(p["a"],{type:"primary",htmlType:"submit",disabled:r,className:"modal-form-button"},n)))}}]),t}(B.a.Component),X=Object(K["a"])({form:"repairApplicationForm",validate:Q})(W);function H(e,t){var a=t.repairApplication;return{initialValues:a,repairApplication:t.repairApplication,submitButtonText:t.submitButtonText||Object(N["formatMessage"])({id:"common.submit"})}}var Z=Object(F["connect"])(H)(X),U=function(e){},G=function(e){function t(){var e,a;O()(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return a=j()(this,(e=M()(t)).call.apply(e,[this].concat(r))),a.state={},a}return R()(t,e),A()(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.handleSubmit,a=e.submitButtonText,n=e.submitting;return B.a.createElement("div",null,B.a.createElement(_["a"],{onSubmit:t,layout:"horizontal",className:"modal-form"},B.a.createElement(D["a"],{name:"approved",label:Object(N["formatMessage"])({id:"app.networkServices.handleResult"}),size:"default",labelCol:{span:6},wrapperCol:{span:18},defaultChecked:!0,checkedChildren:Object(N["formatMessage"])({id:"app.networkServices.handled"}),unCheckedChildren:Object(N["formatMessage"])({id:"app.networkServices.processing"}),component:P["e"]}),B.a.createElement(D["a"],{name:"opinion",type:"text",size:"default",placeholder:"",label:Object(N["formatMessage"])({id:"app.networkServices.opinion"}),required:!0,hasFeedback:!0,labelCol:{span:6},wrapperCol:{span:18},component:P["f"]}),B.a.createElement(p["a"],{type:"primary",htmlType:"submit",disabled:n,className:"modal-form-button"},a)))}}]),t}(B.a.Component),$=Object(K["a"])({form:"repairApplicationExamineForm",validate:U})(G);function ee(e,t){var a=t.repairApplication;return{searching:e.loading.effects["people/people/search"],initialValues:a,repairApplication:t.repairApplication,submitButtonText:t.submitButtonText||Object(N["formatMessage"])({id:"common.submit"})}}var te,ae,ne,re=Object(F["connect"])(ee)($),ie=V["a"].Column,oe=(te=Object(F["connect"])(function(e){return{isAdminOrIsNetworkServicesAdmin:e["auth"].person&&e["auth"].person["roles"].indexOf("admin")>-1||e["auth"].person&&e["auth"].person["roles"].indexOf("networkServicesAdmin")>-1,loading:e.loading.effects["network-services/repair-applications/fetch"],list:e["network-services/repair-applications"].data.list,pagination:e["network-services/repair-applications"].data.pagination}}),te((ne=function(e){function t(){var e,a;O()(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return a=j()(this,(e=M()(t)).call.apply(e,[this].concat(r))),a.state={repairApplication:null,roomsOptions:[],roomsSelectOptions:[],ordering:"",filters:null,filterVisible:!1,filtered:!1,searchText:"",modalTitle:"",modalContent:null,submitButtonText:"",modalVisible:!1,submitting:!1},a.fetchRepairApplications=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=a.props,n=t.dispatch,r=t.pagination,i=a.state,o=i.ordering,s=i.filters,c=i.searchText;n(e?{type:"network-services/repair-applications/fetch",payload:e}:{type:"network-services/repair-applications/fetch",payload:k()({search:c,page:r?r.current:1,ordering:o},s)})},a.fetchRooms=function(){var e=a.props.dispatch;e({type:"rooms/rooms/fetchPublic",payload:{},callback:a.fetchRoomsCallback})},a.fetchRoomsCallback=function(e){a.setState({roomsOptions:L["a"].transferObjectsToFilterOptions(e),roomsSelectOptions:L["a"].transferObjectsToSelectOptionsWithoutID(e)})},a.handleTableChange=function(){var e=w()(g.a.mark(function e(t,n,r){var i,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=a.state.searchText,o=L["a"].transferSorterToOrdering(r),a.setState({ordering:o,filters:n}),e.next=5,a.fetchRepairApplications(k()({search:i,page:t.current,ordering:o},n));case 5:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.editRepairApplication=w()(g.a.mark(function e(){var t,n,r,i,o,s,c,l,p=arguments;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:null,n=a.state,r=n.roomsSelectOptions,i=n.submitting,o=null===t?[Object(N["formatMessage"])({id:"operations.create"},{name:Object(N["formatMessage"])({id:"app.networkServices.repairApplication"})}),Object(N["formatMessage"])({id:"common.create"})]:[Object(N["formatMessage"])({id:"operations.edit"},{name:Object(N["formatMessage"])({id:"app.networkServices.repairApplication"})}),Object(N["formatMessage"])({id:"common.edit"})],s=b()(o,2),c=s[0],l=s[1],e.next=5,a.setState({repairApplication:t?k()({},t):{}});case 5:return e.next=7,a.setState({modalTitle:c,modalContent:B.a.createElement(Z,{repairApplication:a.state.repairApplication,rooms:r,title:c,submitButtonText:l,onSubmit:a.onSubmit,submitting:i}),submitButtonText:l,modalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.deleteRepairApplication=function(){var e=w()(g.a.mark(function e(t){var n;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"network-services/repair-applications/remove",payload:{repairApplication:t},callback:function(){return a.deleteRepairApplicationCallback(t["title"])}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.deleteRepairApplicationCallback=function(e){d["a"].success("".concat(Object(N["formatMessage"])({id:"operations.success-delete"},{name:Object(N["formatMessage"])({id:"app.networkServices.repairApplication"})})," ").concat(e)),a.fetchRepairApplications()},a.onInputChange=function(e){a.setState({searchText:e.target.value})},a.onRepairApplicationSearch=w()(g.a.mark(function e(){var t,n,r,i;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state,n=t.ordering,r=t.filters,i=t.searchText,e.next=3,a.fetchRepairApplications(k()({search:i,page:1,ordering:n},r));case 3:a.setState({filterVisible:!1,filtered:!!i});case 4:case"end":return e.stop()}},e)})),a.handleCancel=w()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.setState({modalVisible:!1,modalContent:null});case 2:case"end":return e.stop()}},e)})),a.onSubmit=function(){var e=w()(g.a.mark(function e(t){var n,r,i;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.repairApplication,i=k()({},t),console.warn("new values: ",i),e.prev=4,e.next=7,a.setState({submitting:!0});case 7:r&&r["id"]?n({type:"network-services/repair-applications/update",payload:{repairApplication:k()({},i)},callback:function(){return a.fetchRepairApplications()}}):n({type:"network-services/repair-applications/add",payload:{repairApplication:i},callback:function(){return a.fetchRepairApplications()}}),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](4),console.log(e.t0);case 13:return e.prev=13,e.next=16,a.setState({submitting:!1});case 16:return e.finish(13);case 17:return e.next=19,a.setState({modalVisible:!1,modalContent:null});case 19:case"end":return e.stop()}},e,null,[[4,10,13,17]])}));return function(t){return e.apply(this,arguments)}}(),a.examineRepairApplication=w()(g.a.mark(function e(){var t,n,r,i,o,s,c,l=arguments;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:null,n=a.state,r=n.roomsSelectOptions,i=n.submitting,o=[Object(N["formatMessage"])({id:"operations.examine"},{name:Object(N["formatMessage"])({id:"app.networkServices.repairApplication"})}),Object(N["formatMessage"])({id:"common.examine"})],s=o[0],c=o[1],e.next=5,a.setState({repairApplication:t?k()({},t,{room:"".concat(t["room_detail"]["name"],"(").concat(t["room_detail"]["id"],")")}):{}});case 5:return e.next=7,a.setState({modalTitle:s,modalContent:B.a.createElement(re,{repairApplication:a.state.repairApplication,rooms:r,title:s,submitButtonText:c,onSubmit:a.onRepairApplicationExamineSubmit,submitting:i}),submitButtonText:c,modalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.onRepairApplicationExamineSubmit=function(){var e=w()(g.a.mark(function e(t){var n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.repairApplication,e.prev=2,e.next=5,a.setState({submitting:!0});case 5:n({type:"network-services/repair-applications/examine",payload:k()({},t,{id:r.id}),callback:function(){return a.fetchRepairApplications()}}),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](2),console.log(e.t0);case 11:return e.prev=11,e.next=14,a.setState({submitting:!1});case 14:return e.finish(11);case 15:return e.next=17,a.setState({modalVisible:!1,modalContent:null});case 17:case"end":return e.stop()}},e,null,[[2,8,11,15]])}));return function(t){return e.apply(this,arguments)}}(),a}return R()(t,e),A()(t,[{key:"componentDidMount",value:function(){this.fetchRepairApplications(),this.fetchRooms()}},{key:"render",value:function(){var e=this,t=this.props,a=t.isAdminOrIsNetworkServicesAdmin,d=t.list,f=t.pagination,b=t.loading,h=this.state,g=h.roomsOptions,v=h.filtered,w=h.filterVisible,x=h.modalTitle,k=h.modalContent,E=h.modalVisible;return console.warn("list, pages, loading:",d,f,b,a),B.a.createElement(q["a"],{title:Object(N["formatMessage"])({id:"operations.management"},{name:Object(N["formatMessage"])({id:"app.networkServices.repairApplication"})})},B.a.createElement(n["a"],{bordered:!1},f&&B.a.createElement(z["a"],null,f.total),B.a.createElement(m["a"],{title:x,visible:E,onCancel:this.handleCancel,footer:null},k||B.a.createElement(u["a"],{spinning:b})),B.a.createElement(p["a"],{type:"primary",onClick:function(){return e.editRepairApplication()}},B.a.createElement(N["FormattedMessage"],{id:"operations.apply",values:{name:Object(N["formatMessage"])({id:"app.networkServices.repairApplication"})}})),B.a.createElement(V["a"],{dataSource:d,loading:b,rowKey:"id",onChange:this.handleTableChange,pagination:f,width:1920,scroll:{x:1920}},B.a.createElement(ie,{title:Object(N["formatMessage"])({id:"common.title"}),dataIndex:"title",filterDropdown:B.a.createElement("div",{className:"table-input-search"},B.a.createElement(l["a"],{placeholder:Object(N["formatMessage"])({id:"common.title"}),value:this.state.searchText,onChange:this.onInputChange,onPressEnter:this.onRepairApplicationSearch}),B.a.createElement(p["a"],{type:"primary",onClick:this.onRepairApplicationSearch},B.a.createElement(N["FormattedMessage"],{id:"common.search"}))),filterIcon:B.a.createElement(c["a"],{type:"search",style:{color:v?"#108ee9":"#aaa"}}),filterDropdownVisible:w,onFilterDropdownVisibleChange:function(t){e.setState({filterVisible:t})}}),B.a.createElement(ie,{title:Object(N["formatMessage"])({id:"common.content"}),dataIndex:"content"}),B.a.createElement(ie,{title:Object(N["formatMessage"])({id:"app.rooms.room"}),dataIndex:"room",render:function(e,t){return t["room_detail"]?t["room_detail"]["name"]:""},filters:g}),B.a.createElement(ie,{title:Object(N["formatMessage"])({id:"common.category"}),dataIndex:"category",render:function(e,t){return t["get_category_display"]}}),B.a.createElement(ie,{title:Object(N["formatMessage"])({id:"common.submit"}),dataIndex:"submitted",render:function(e){return e?B.a.createElement(s["a"],{status:"success",text:Object(N["formatMessage"])({id:"common.submitted"})}):B.a.createElement(s["a"],{status:"error",text:Object(N["formatMessage"])({id:"common.non-submitted"})})}}),B.a.createElement(ie,{title:"\u7533\u8bf7\u4eba",dataIndex:"person",render:function(e,t){return t["person_detail"]?t["person_detail"]["name"]:t["person"]}}),B.a.createElement(ie,{title:Object(N["formatMessage"])({id:"app.networkServices.opinion"}),dataIndex:"opinion"}),B.a.createElement(ie,{title:Object(N["formatMessage"])({id:"app.networkServices.handleResult"}),dataIndex:"approved",render:function(e){return e?B.a.createElement(s["a"],{status:"success",text:Object(N["formatMessage"])({id:"app.networkServices.handled"})}):B.a.createElement(s["a"],{status:"default",text:Object(N["formatMessage"])({id:"app.networkServices.processing"})})}}),B.a.createElement(ie,{title:Object(N["formatMessage"])({id:"app.networkServices.examiner"}),dataIndex:"examiner",render:function(e,t){return t["examiner_detail"]?t["examiner_detail"]["name"]:t["examiner"]}}),B.a.createElement(ie,{title:Object(N["formatMessage"])({id:"common.operations"}),width:152,fixed:"right",render:function(t,n){return B.a.createElement("div",null,B.a.createElement("a",{onClick:function(){return e.editRepairApplication(n)}},Object(N["formatMessage"])({id:"common.edit"})),B.a.createElement("span",{className:"ant-divider"}),B.a.createElement(r["a"],{overlay:B.a.createElement(o["a"],null,a&&B.a.createElement(o["a"].Item,null,B.a.createElement("a",{onClick:function(){return e.examineRepairApplication(n)}},Object(N["formatMessage"])({id:"common.examine"}))),B.a.createElement(o["a"].Item,null,B.a.createElement(i["a"],{title:Object(N["formatMessage"])({id:"common.delete-ask"}),onConfirm:function(){return e.deleteRepairApplication(n)}},B.a.createElement("a",{href:"#"},B.a.createElement(N["FormattedMessage"],{id:"common.delete"})))))},B.a.createElement("a",{className:"ant-dropdown-link"},B.a.createElement(N["FormattedMessage"],{id:"common.more"})," ",B.a.createElement(c["a"],{type:"down"}))))}}))))}}]),t}(I["PureComponent"]),ae=ne))||ae);t["default"]=oe}}]);