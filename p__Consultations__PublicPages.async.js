(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{W1LX:function(t,e,a){"use strict";a.r(e);a("2qtc");var n,s,o,i,l,c,r=a("kLXV"),u=(a("miYZ"),a("tsqr")),p=a("p0pE"),d=a.n(p),m=a("d6i3"),b=a.n(m),h=a("1l/V"),f=a.n(h),v=a("2Taf"),g=a.n(v),E=a("vZ4D"),k=a.n(E),y=a("l4Ni"),C=a.n(y),w=a("ujKo"),B=a.n(w),Q=a("MhPg"),x=a.n(Q),O=a("q1tI"),S=a.n(O),T=a("MuoO"),q=a("3a4m"),M=a.n(q),j=a("wY1l"),L=a.n(j),V=a("LLXN"),D=a("yxjg"),P=a("aQu0"),Y=a("QetY"),I=a("+6Dn"),N=a("Mt1y"),W=a("WYlG"),X=a("X3JL"),A=a("mWfr"),F=(n=Object(T["connect"])(),n((o=function(t){function e(){var t,a;g()(this,e);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=C()(this,(t=B()(e)).call.apply(t,[this].concat(s))),a.state={topQuestions:[]},a.fetchTopQuestions=function(){var t=a.props.dispatch;t({type:"consultations/questions/fetchTop",payload:{},callback:a.fetchTopQuestionsCallback})},a.fetchTopQuestionsCallback=function(t){a.setState({topQuestions:t})},a.selectQuestion=function(t){var e=a.props.dispatch;e({type:"consultations/questions/select",payload:{selectedQuestion:t}}),M.a.push("/public/consultations/consultation")},a}return x()(e,t),k()(e,[{key:"componentDidMount",value:function(){this.fetchTopQuestions()}},{key:"render",value:function(){var t=this,e=this.state.topQuestions;return S.a.createElement(S.a.Fragment,null,S.a.createElement(P["a"],{as:"h3"},S.a.createElement(V["FormattedMessage"],{id:"app.consultations.top-questions"})),S.a.createElement(W["a"],null,e&&e.length>0&&e.map(function(e,a){return S.a.createElement(W["a"].Item,{key:a,as:"a",onClick:function(){return t.selectQuestion(e)}},S.a.createElement(A["a"],{text:e.title,maxLine:"1",ellipsis:"...",trimRight:!0,basedOn:"letters"}))})))}}]),e}(O["PureComponent"]),s=o))||s),J=F,R=a("H/rY"),H=a("6NK7"),K=(i=Object(T["connect"])(function(t){return{selectedBoard:t["consultations/boards"].selectedBoard,selectedQuestion:t["consultations/questions"].selectedQuestion,loading:t.loading.effects["consultations/questions/fetch"],list:t["consultations/questions"].data.list,pagination:t["consultations/questions"].data.pagination}}),i((c=function(t){function e(){var t,a;g()(this,e);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=C()(this,(t=B()(e)).call.apply(t,[this].concat(s))),a.state={searchText:"",boards:[],boardsSelectOptions:[],questions:[],consultations:[],modalTitle:"",modalContent:null,submitButtonText:"",modalVisible:!1,submitting:!1},a.fetchBoards=function(){var t=a.props.dispatch;t({type:"consultations/boards/fetchPublic",payload:{},callback:a.fetchBoardsCallback})},a.fetchBoardsCallback=function(t){a.setState({boardsSelectOptions:H["a"].transferObjectsToSelectOptionsWithoutID(t)})},a.fetchTopBoards=function(){var t=a.props.dispatch;t({type:"consultations/boards/fetchTop",payload:{},callback:a.fetchTopBoardsCallback})},a.fetchTopBoardsCallback=function(t){a.setState({boards:t})},a.selectBoard=function(t){var e=a.props.dispatch;a.props.board&&t["id"]===a.props.board["id"]||(e({type:"consultations/boards/select",payload:{board:t}}),M.a.push("/public/consultations/consultations"))},a.deSelectBoard=function(){var t=a.props.dispatch;t({type:"consultations/boards/select",payload:{board:null}}),M.a.push("/public/consultations/consultations")},a.toBoardList=function(){M.a.push("/public/consultations/boards")},a.selectQuestion=function(t){var e=a.props.dispatch;e({type:"consultations/questions/select",payload:{selectedQuestion:t}}),M.a.push("/public/consultations/consultation")},a.getTitle=function(t){var e=a.props,n=e.selectedBoard,s=e.selectedQuestion;if(t&&t["props"]&&t["props"]["location"]&&t["props"]["location"]["pathname"]&&t["props"]["location"]["pathname"].length>0){var o=t["props"]["location"]["pathname"];return"/public/consultations/boards"===o?Object(V["formatMessage"])({id:"app.consultations.board-list"}):"/public/consultations/boards"===o?Object(V["formatMessage"])({id:"app.consultations.board"}):"/public/consultations/consultations"===o?n?"".concat(Object(V["formatMessage"])({id:"app.consultations"})," \u2014 ").concat(n["name"]):"".concat(Object(V["formatMessage"])({id:"app.consultations"})):"/public/consultations/consultation"===o?s?s["title"]:"123":Object(V["formatMessage"])({id:"app.consultations"})}},a.addQuestion=f()(b.a.mark(function t(){var e,n,s,o,i,l;return b.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=a.state,n=e.boardsSelectOptions,s=e.submitting,o=[Object(V["formatMessage"])({id:"operations.create"},{name:Object(V["formatMessage"])({id:"app.consultations.questions"})}),Object(V["formatMessage"])({id:"common.create"})],i=o[0],l=o[1],t.next=4,a.setState({question:{}});case 4:return t.next=6,a.setState({modalTitle:i,modalContent:S.a.createElement(R["a"],{question:a.state.question,boards:n,title:i,submitButtonText:l,onSubmit:a.onSubmit,submitting:s}),submitButtonText:l,modalVisible:!0});case 6:case"end":return t.stop()}},t)})),a.handleCancel=f()(b.a.mark(function t(){return b.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.setState({modalVisible:!1,modalContent:null});case 2:case"end":return t.stop()}},t)})),a.onSubmit=function(){var t=f()(b.a.mark(function t(e){var n,s;return b.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=a.props.dispatch,a.state.question,s=d()({},e,{visible:!!e["visible"]}),console.warn("new values: ",s),t.prev=4,t.next=7,a.setState({submitting:!0});case 7:n({type:"consultations/questions/add",payload:{question:s},callback:function(){return a.onSubmitCallback("\u63d0\u4ea4\u6210\u529f\u3002\u6839\u636e\u76f8\u5173\u6cd5\u5f8b\u89c4\u5b9a\uff0c\u60a8\u7684\u95ee\u9898\u5c06\u4f1a\u5728\u5ba1\u6838\u540e\u663e\u793a\uff0c\u8bf7\u52ff\u91cd\u590d\u63d0\u95ee\u3002")}}),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](4),console.log(t.t0);case 13:return t.prev=13,t.next=16,a.setState({submitting:!1});case 16:return t.finish(13);case 17:return t.next=19,a.setState({modalVisible:!1,modalContent:null});case 19:case"end":return t.stop()}},t,null,[[4,10,13,17]])}));return function(e){return t.apply(this,arguments)}}(),a}return x()(e,t),k()(e,[{key:"componentDidMount",value:function(){this.fetchBoards(),this.fetchTopBoards()}},{key:"onSubmitCallback",value:function(t){u["a"].success(t,5)}},{key:"render",value:function(){var t=this,e=this.state,a=e.boards,n=e.modalTitle,s=e.modalContent,o=e.modalVisible,i=this.props.children;return S.a.createElement(S.a.Fragment,null,S.a.createElement(r["a"],{title:n,visible:o,onCancel:this.handleCancel,footer:null},s),S.a.createElement(P["a"],{as:"h2",textAlign:"center"},this.getTitle(i)),S.a.createElement(Y["a"],{className:"center",onClick:function(){return t.addQuestion()}},"\u6211\u8981\u54a8\u8be2"),S.a.createElement(I["a"],{celled:"internally"},S.a.createElement(I["a"].Row,{columns:2},S.a.createElement(I["a"].Column,{id:"contents",width:11},S.a.createElement(D["a"].Provider,{value:{name:"123",selectBoard:this.selectBoard,selectQuestion:this.selectQuestion}},this.props.children)),S.a.createElement(I["a"].Column,{width:5},S.a.createElement(J,null),S.a.createElement(N["a"],null),S.a.createElement(P["a"],{as:"h3"},Object(V["formatMessage"])({id:"app.consultations.top-boards"}),S.a.createElement("span",{style:{fontSize:12}}," ","[",S.a.createElement("a",{onClick:this.deSelectBoard},Object(V["formatMessage"])({id:"app.consultations.all-consultations"}))," | ",S.a.createElement("a",{onClick:this.toBoardList},Object(V["formatMessage"])({id:"app.consultations.all-boards"})),"]")),S.a.createElement(W["a"],{selection:!0,relaxed:!0},a&&a.length>0&&a.map(function(e,a){return S.a.createElement(W["a"].Item,{onClick:function(){return t.selectBoard(e)},key:a},S.a.createElement(W["a"].Header,null,e["name"]),S.a.createElement(W["a"].Description,null,S.a.createElement(A["a"],{text:e["introduction"],maxLine:"2",ellipsis:"...",trimRight:!0,basedOn:"letters"})))})),S.a.createElement(N["a"],null),S.a.createElement(Y["a"],{onClick:function(){return t.addQuestion()}},"\u6211\u8981\u63d0\u95ee"),S.a.createElement(L.a,{to:"/consultations/questions"},S.a.createElement(Y["a"],null,"\u6211\u7684\u54a8\u8be2"))))),S.a.createElement(X["a"],null))}}]),e}(O["PureComponent"]),l=c))||l);e["default"]=K}}]);