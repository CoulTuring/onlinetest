(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[95],{L3yc:function(t,e,a){"use strict";a.r(e);a("IzEo");var n=a("bx4M"),r=(a("qVdP"),a("jsC+")),i=(a("lUTK"),a("BvKs")),o=(a("Pwec"),a("CtXQ")),s=(a("5NDa"),a("5rEg")),l=(a("+L6B"),a("2/Rp")),c=(a("T2oS"),a("W9HT")),u=(a("miYZ"),a("tsqr")),d=(a("2qtc"),a("kLXV")),p=a("qIgq"),m=a.n(p),h=a("d6i3"),f=a.n(h),b=a("1l/V"),v=a.n(b),g=a("p0pE"),w=a.n(g),y=a("2Taf"),x=a.n(y),E=a("vZ4D"),C=a.n(E),k=a("l4Ni"),T=a.n(k),S=a("ujKo"),A=a.n(S),V=a("MhPg"),O=a.n(V),P=(a("g9YV"),a("wCAj")),I=a("q1tI"),B=a.n(I),N=a("MuoO"),q=a("zHco"),D=a("FkSf"),F=(a("y8nQ"),a("Vl3Y")),j=a("d/v1"),_=a("pJVQ"),z=a("p9nB"),K=a("WAby"),M=a("6NK7"),J=function(t){},L=function(t){function e(){var t,a;x()(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return a=T()(this,(t=A()(e)).call.apply(t,[this].concat(r))),a.state={peopleOptions:[],selectedPeople:[]},a.searchPeople=function(t,e){var n=a.props.dispatch;n({type:"people/people/search",payload:{person:e},callback:a.searchPeopleCallback})},a.searchPeopleCallback=function(t){var e=M["a"].transferPeopleToOptionsWithName(t);a.setState({peopleOptions:e})},a}return O()(e,t),C()(e,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var t=this.props,e=t.searching,a=t.handleSubmit,n=t.submitButtonText,r=t.submitting,i=this.state.peopleOptions;return B.a.createElement("div",null,B.a.createElement(F["a"],{onSubmit:a,layout:"horizontal",className:"modal-form"},B.a.createElement(j["a"],{name:"person",label:"\u7ba1\u7406\u5458",size:"default",mode:"combobox",labelCol:{span:6},wrapperCol:{span:18},options:i,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onFocus:this.searchPeople,onChange:this.searchPeople,required:!1,hasFeedback:!0,validate:[K["g"],K["d"]],notFoundContent:e?B.a.createElement(c["a"],{size:"small"}):null,component:z["d"]}),B.a.createElement(l["a"],{type:"primary",htmlType:"submit",disabled:r,className:"modal-form-button"},n)))}}]),e}(B.a.Component),Q=Object(_["a"])({form:"shuttlesAdministratorForm",validate:J})(L);function W(t,e){var a=e.administrator;return{searching:t.loading.effects["people/people/search"],initialValues:a,administrator:e.administrator,submitButtonText:e.submitButtonText||"\u63d0\u4ea4"}}var Y,H,X,Z=Object(N["connect"])(W)(Q),R=P["a"].Column,U=(Y=Object(N["connect"])(function(t){return{loading:t.loading.effects["shuttles/administrators/fetch"],test:t["shuttles/administrators"].test,state:t,list:t["shuttles/administrators"].data.list,pagination:t["shuttles/administrators"].data.pagination}}),Y((X=function(t){function e(){var t,a;x()(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return a=T()(this,(t=A()(e)).call.apply(t,[this].concat(r))),a.state={administrator:null,ordering:"",filters:null,filterVisible:!1,filtered:!1,searchText:"",modalTitle:"",modalContent:null,submitButtonText:"",modalVisible:!1,submitting:!1},a.fetchAdministrators=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=a.props,n=e.dispatch,r=e.pagination,i=a.state,o=i.ordering,s=i.filters,l=i.searchText;n(t?{type:"shuttles/administrators/fetch",payload:t}:{type:"shuttles/administrators/fetch",payload:w()({search:l,page:r?r.current:1,ordering:o},s)})},a.handleTableChange=function(){var t=v()(f.a.mark(function t(e,n,r){var i,o;return f.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=a.state.searchText,o=M["a"].transferSorterToOrdering(r),a.setState({ordering:o,filters:n}),t.next=5,a.fetchAdministrators(w()({search:i,page:e.current,ordering:o},n));case 5:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}(),a.editAdministrator=v()(f.a.mark(function t(){var e,n,r,i,o,s,l=arguments;return f.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=l.length>0&&void 0!==l[0]?l[0]:null,n=a.state.submitting,r=null===e?["\u521b\u5efa\u7ba1\u7406\u5458","\u521b\u5efa"]:["\u7f16\u8f91\u7ba1\u7406\u5458","\u7f16\u8f91"],i=m()(r,2),o=i[0],s=i[1],t.next=5,a.setState({administrator:e?w()({},e,{person:"".concat(e["person_detail"]["name"],"(").concat(e["person_detail"]["id"],")")}):{}});case 5:return t.next=7,a.setState({modalTitle:o,modalContent:B.a.createElement(Z,{administrator:a.state.administrator,title:o,submitButtonText:s,onSubmit:a.onSubmit,submitting:n}),submitButtonText:s,modalVisible:!0});case 7:case"end":return t.stop()}},t)})),a.deleteAdministrator=function(){var t=v()(f.a.mark(function t(e){var n;return f.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=a.props.dispatch,d["a"].confirm({title:"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u7ba1\u7406\u5458 ".concat(e["person_detail"]["name"]," \u5417?"),content:"\u5220\u9664\u540e\u5c06\u4e0d\u53ef\u6062\u590d\uff0c\u5176\u76f8\u5173\u6570\u636e\u3001\u4fe1\u606f\u4e5f\u5c06\u4e00\u5e76\u5220\u9664\u3002",onOk:function(){var t=v()(f.a.mark(function t(){return f.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n({type:"shuttles/administrators/remove",payload:{administrator:e},callback:function(){return a.fetchAdministrators()}}),u["a"].success("\u6210\u529f\u5220\u9664\u7ba1\u7406\u5458 ".concat(e["person_detail"]["name"],"\u3002"));case 2:case"end":return t.stop()}},t)}));function r(){return t.apply(this,arguments)}return r}(),onCancel:function(){}});case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),a.onInputChange=function(t){a.setState({searchText:t.target.value})},a.onAdministratorSearch=v()(f.a.mark(function t(){var e,n,r,i;return f.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=a.state,n=e.ordering,r=e.filters,i=e.searchText,t.next=3,a.fetchAdministrators(w()({search:i,page:1,ordering:n},r));case 3:a.setState({filterVisible:!1,filtered:!!i});case 4:case"end":return t.stop()}},t)})),a.handleCancel=v()(f.a.mark(function t(){return f.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.setState({modalVisible:!1,modalContent:null});case 2:case"end":return t.stop()}},t)})),a.onSubmit=function(){var t=v()(f.a.mark(function t(e){var n,r,i,o;return f.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=a.props.dispatch,r=a.state.administrator,i=/\((\w{4,11})\)/.exec(e["person"]),o=w()({},e,{person:i[1]}),t.prev=4,t.next=7,a.setState({submitting:!0});case 7:r&&r["id"]?n({type:"shuttles/administrators/update",payload:{administrator:w()({},o)},callback:function(){return a.fetchAdministrators()}}):n({type:"shuttles/administrators/add",payload:{administrator:o},callback:function(){return a.fetchAdministrators()}}),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](4),console.log(t.t0);case 13:return t.prev=13,t.next=16,a.setState({submitting:!1});case 16:return t.finish(13);case 17:return t.next=19,a.setState({modalVisible:!1,modalContent:null});case 19:case"end":return t.stop()}},t,null,[[4,10,13,17]])}));return function(e){return t.apply(this,arguments)}}(),a}return O()(e,t),C()(e,[{key:"componentDidMount",value:function(){this.fetchAdministrators()}},{key:"render",value:function(){var t=this,e=this.props,a=e.list,u=e.pagination,p=e.loading,m=e.state;console.log("state: ",m);var h=this.state,f=h.filtered,b=h.filterVisible,v=h.modalTitle,g=h.modalContent,w=h.modalVisible;return B.a.createElement(q["a"],{title:"\u901a\u52e4\u5e94\u7528\u7ba1\u7406\u5458"},B.a.createElement(n["a"],{bordered:!1},u&&B.a.createElement(D["a"],null,u.total),B.a.createElement(d["a"],{title:v,visible:w,onCancel:this.handleCancel,footer:null},g||B.a.createElement(c["a"],{spinning:p})),B.a.createElement(l["a"],{type:"primary",onClick:function(){return t.editAdministrator()}},"\u65b0\u5efa\u7ba1\u7406\u5458"),B.a.createElement(P["a"],{dataSource:a,loading:p,rowKey:"id",onChange:this.handleTableChange,pagination:u,width:1e3,scroll:{x:1e3}},B.a.createElement(R,{title:"\u7ba1\u7406\u5458",dataIndex:"person",filterDropdown:B.a.createElement("div",{className:"table-input-search"},B.a.createElement(s["a"],{placeholder:"\u540d\u79f0",value:this.state.searchText,onChange:this.onInputChange,onPressEnter:this.onAdministratorSearch}),B.a.createElement(l["a"],{type:"primary",onClick:this.onAdministratorSearch},"\u68c0\u7d22")),filterIcon:B.a.createElement(o["a"],{type:"search",style:{color:f?"#108ee9":"#aaa"}}),filterDropdownVisible:b,onFilterDropdownVisibleChange:function(e){t.setState({filterVisible:e})},render:function(t,e){return e["person_detail"]?e["person_detail"]["name"]:e["person"]}}),B.a.createElement(R,{title:"\u4fee\u6539\u65f6\u95f4",dataIndex:"modified",sorter:!0}),B.a.createElement(R,{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"created"}),B.a.createElement(R,{title:"\u64cd\u4f5c",width:152,fixed:"right",render:function(e,a){return B.a.createElement("div",null,B.a.createElement("a",{onClick:function(){return t.editAdministrator(a)}},"\u7f16\u8f91"),B.a.createElement("span",{className:"ant-divider"}),B.a.createElement(r["a"],{overlay:B.a.createElement(i["a"],null,B.a.createElement(i["a"].Item,null,B.a.createElement("a",{onClick:function(){return t.deleteAdministrator(a)}},"\u5220\u9664")))},B.a.createElement("a",{className:"ant-dropdown-link"},"\u66f4\u591a ",B.a.createElement(o["a"],{type:"down"}))))}}))))}}]),e}(I["PureComponent"]),H=X))||H);e["default"]=U}}]);