(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[101],{jQ9k:function(e,t,a){"use strict";a.r(t);a("IzEo");var n=a("bx4M"),r=(a("qVdP"),a("jsC+")),l=(a("lUTK"),a("BvKs")),s=(a("Awhp"),a("KrTs")),o=(a("Pwec"),a("CtXQ")),i=(a("5NDa"),a("5rEg")),c=(a("+L6B"),a("2/Rp")),u=(a("T2oS"),a("W9HT")),p=(a("miYZ"),a("tsqr")),d=(a("2qtc"),a("kLXV")),h=a("qIgq"),m=a.n(h),f=a("d6i3"),b=a.n(f),v=a("1l/V"),g=a.n(v),w=a("p0pE"),x=a.n(w),y=a("2Taf"),E=a.n(y),C=a("vZ4D"),S=a.n(C),k=a("l4Ni"),T=a.n(k),V=a("ujKo"),I=a.n(V),q=a("MhPg"),B=a.n(q),N=(a("g9YV"),a("wCAj")),j=a("q1tI"),z=a.n(j),D=a("MuoO"),F=a("zHco"),K=a("FkSf"),O=(a("y8nQ"),a("Vl3Y")),A=a("d/v1"),M=a("pJVQ"),P=a("p9nB"),Q=a("WAby"),J=function(e){},Y=function(e){function t(){var e,a;E()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=T()(this,(e=I()(t)).call.apply(e,[this].concat(r))),a.state={},a}return B()(t,e),S()(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=(e.stop,e.handleSubmit),a=e.submitButtonText,n=e.submitting;return z.a.createElement("div",null,z.a.createElement(O["a"],{onSubmit:t,layout:"horizontal",className:"modal-form"},z.a.createElement(A["a"],{name:"name",type:"text",size:"default",placeholder:"\u7ad9\u70b9\u540d\u79f0",label:"\u540d\u79f0",required:!0,hasFeedback:!0,validate:[Q["g"]],labelCol:{span:6},wrapperCol:{span:18},component:P["g"]}),z.a.createElement(A["a"],{name:"serial",type:"text",size:"default",placeholder:"",label:"\u5e8f\u53f7",required:!0,hasFeedback:!0,validate:[Q["g"]],labelCol:{span:6},wrapperCol:{span:18},component:P["b"]}),z.a.createElement(A["a"],{name:"notes",type:"text",size:"default",placeholder:"",label:"\u5907\u6ce8",required:!0,hasFeedback:!0,validate:[Q["g"]],labelCol:{span:6},wrapperCol:{span:18},component:P["f"]}),z.a.createElement(A["a"],{name:"visible",label:"\u53ef\u67e5\u8be2",size:"default",labelCol:{span:6},wrapperCol:{span:18},defaultChecked:!0,checkedChildren:"\u53ef\u67e5\u8be2",unCheckedChildren:"\u4e0d\u53ef\u89c1",component:P["e"]}),z.a.createElement(c["a"],{type:"primary",htmlType:"submit",disabled:n,className:"modal-form-button"},a)))}}]),t}(z.a.Component),H=Object(M["a"])({form:"stopForm",validate:J})(Y);function L(e,t){var a=t.stop;return{initialValues:a,stop:t.stop,submitButtonText:t.submitButtonText||"\u63d0\u4ea4"}}var W,X,Z,R=Object(D["connect"])(L)(H),U=a("6NK7"),G=N["a"].Column,$=(W=Object(D["connect"])(function(e){return{loading:e.loading.effects["shuttles/stops/fetch"],test:e["shuttles/stops"].test,state:e,list:e["shuttles/stops"].data.list,pagination:e["shuttles/stops"].data.pagination}}),W((Z=function(e){function t(){var e,a;E()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=T()(this,(e=I()(t)).call.apply(e,[this].concat(r))),a.state={stop:null,ordering:"",filters:null,filterVisible:!1,filtered:!1,searchText:"",modalTitle:"",modalContent:null,submitButtonText:"",modalVisible:!1,submitting:!1},a.fetchStops=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=a.props,n=t.dispatch,r=t.pagination,l=a.state,s=l.ordering,o=l.filters,i=l.searchText;n(e?{type:"shuttles/stops/fetch",payload:e}:{type:"shuttles/stops/fetch",payload:x()({search:i,page:r?r.current:1,ordering:s},o)})},a.handleTableChange=function(){var e=g()(b.a.mark(function e(t,n,r){var l,s;return b.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return l=a.state.searchText,s=U["a"].transferSorterToOrdering(r),a.setState({ordering:s,filters:n}),e.next=5,a.fetchStops(x()({search:l,page:t.current,ordering:s},n));case 5:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.editStop=g()(b.a.mark(function e(){var t,n,r,l,s,o,i=arguments;return b.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:null,n=a.state.submitting,r=null===t?["\u521b\u5efa\u7ad9\u70b9","\u521b\u5efa"]:["\u7f16\u8f91\u7ad9\u70b9","\u7f16\u8f91"],l=m()(r,2),s=l[0],o=l[1],e.next=5,a.setState({stop:t});case 5:return e.next=7,a.setState({modalTitle:s,modalContent:z.a.createElement(R,{stop:a.state.stop,title:s,submitButtonText:o,onSubmit:a.onSubmit,submitting:n}),submitButtonText:o,modalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.deleteStop=function(){var e=g()(b.a.mark(function e(t){var n;return b.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,d["a"].confirm({title:"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u7ad9\u70b9 ".concat(t["name"]," \u5417?"),content:"\u5220\u9664\u540e\u5c06\u4e0d\u53ef\u6062\u590d\uff0c\u5176\u76f8\u5173\u6570\u636e\u3001\u4fe1\u606f\u4e5f\u5c06\u4e00\u5e76\u5220\u9664\u3002",onOk:function(){var e=g()(b.a.mark(function e(){return b.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n({type:"shuttles/stops/remove",payload:{stop:t},callback:function(){return a.fetchStops()}}),p["a"].success("\u6210\u529f\u5220\u9664\u7ad9\u70b9 ".concat(t["name"],"\u3002"));case 2:case"end":return e.stop()}},e)}));function r(){return e.apply(this,arguments)}return r}(),onCancel:function(){}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onInputChange=function(e){a.setState({searchText:e.target.value})},a.onStopSearch=g()(b.a.mark(function e(){var t,n,r,l;return b.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state,n=t.ordering,r=t.filters,l=t.searchText,e.next=3,a.fetchStops(x()({search:l,page:1,ordering:n},r));case 3:a.setState({filterVisible:!1,filtered:!!l});case 4:case"end":return e.stop()}},e)})),a.handleCancel=g()(b.a.mark(function e(){return b.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.setState({stop:null,modalVisible:!1,modalContent:null});case 2:case"end":return e.stop()}},e)})),a.onSubmit=function(){var e=g()(b.a.mark(function e(t){var n,r,l;return b.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.stop,l=x()({},t,{visible:!!t["visible"]}),e.prev=3,e.next=6,a.setState({submitting:!0});case 6:r&&r["id"]?n({type:"shuttles/stops/update",payload:{stop:x()({},l)},callback:function(){return a.fetchStops()}}):n({type:"shuttles/stops/add",payload:{stop:l},callback:function(){return a.fetchStops()}}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](3),console.log(e.t0);case 12:return e.prev=12,e.next=15,a.setState({submitting:!1});case 15:return e.finish(12);case 16:return e.next=18,a.setState({stop:null,modalVisible:!1,modalContent:null});case 18:case"end":return e.stop()}},e,null,[[3,9,12,16]])}));return function(t){return e.apply(this,arguments)}}(),a}return B()(t,e),S()(t,[{key:"componentDidMount",value:function(){this.fetchStops()}},{key:"render",value:function(){var e=this,t=this.props,a=t.list,p=t.pagination,h=t.loading,m=t.state,f=this.state,b=f.filtered,v=f.filterVisible,g=f.modalTitle,w=f.modalContent,x=f.modalVisible;return console.warn("list, pages, loading:",a,p,h,m),z.a.createElement(F["a"],{title:"\u7ad9\u70b9\u7ba1\u7406"},z.a.createElement(n["a"],{bordered:!1},p&&z.a.createElement(K["a"],null,p.total),z.a.createElement(d["a"],{title:g,visible:x,onCancel:this.handleCancel,footer:null},w||z.a.createElement(u["a"],{spinning:h})),z.a.createElement(c["a"],{type:"primary",onClick:function(){return e.editStop()}},"\u65b0\u5efa\u7ad9\u70b9"),z.a.createElement(N["a"],{dataSource:a,loading:h,rowKey:"id",onChange:this.handleTableChange,pagination:p,width:1e3,scroll:{x:1e3}},z.a.createElement(G,{title:"\u540d\u79f0",dataIndex:"name",filterDropdown:z.a.createElement("div",{className:"table-input-search"},z.a.createElement(i["a"],{placeholder:"\u540d\u79f0",value:this.state.searchText,onChange:this.onInputChange,onPressEnter:this.onStopSearch}),z.a.createElement(c["a"],{type:"primary",onClick:this.onStopSearch},"\u68c0\u7d22")),filterIcon:z.a.createElement(o["a"],{type:"search",style:{color:b?"#108ee9":"#aaa"}}),filterDropdownVisible:v,onFilterDropdownVisibleChange:function(t){e.setState({filterVisible:t})}}),z.a.createElement(G,{title:"\u5e8f\u53f7",dataIndex:"serial"}),z.a.createElement(G,{title:"\u5907\u6ce8",dataIndex:"notes"}),z.a.createElement(G,{title:"\u53ef\u67e5\u8be2",dataIndex:"visible",render:function(e){return e?z.a.createElement(s["a"],{status:"success",text:"\u5f00\u653e"}):z.a.createElement(s["a"],{status:"default",text:"\u5173\u95ed"})}}),z.a.createElement(G,{title:"\u64cd\u4f5c",width:152,fixed:"right",render:function(t,a){return z.a.createElement("div",null,z.a.createElement("a",{onClick:function(){return e.editStop(a)}},"\u7f16\u8f91"),z.a.createElement("span",{className:"ant-divider"}),z.a.createElement(r["a"],{overlay:z.a.createElement(l["a"],null,z.a.createElement(l["a"].Item,null,z.a.createElement("a",{onClick:function(){return e.deleteStop(a)}},"\u5220\u9664")))},z.a.createElement("a",{className:"ant-dropdown-link"},"\u66f4\u591a ",z.a.createElement(o["a"],{type:"down"}))))}}))))}}]),t}(j["PureComponent"]),X=Z))||X);t["default"]=$}}]);